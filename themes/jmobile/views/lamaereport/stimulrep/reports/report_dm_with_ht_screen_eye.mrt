<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<StiSerializer version="1.02" type="Flex" application="StiReport">
  <Dictionary isKey="true" type="Dictionary" Ref="1">
    <Databases count="1" isList="true">
      <Connection1 isKey="true" type="Stimulsoft.Report.Dictionary.StiMySqlDatabase" Ref="2">
        <Alias>Connection1</Alias>
        <ConnectionString>server=192.168.1.253;database=hos;user=hospital;password=lamae;</ConnectionString>
        <Name>Connection1</Name>
      </Connection1>
    </Databases>
    <DataSources count="1" isList="true">
      <DataSource1 isKey="true" type="Stimulsoft.Report.Dictionary.StiMySqlSource" Ref="3">
        <Alias>DataSource1</Alias>
        <Columns count="11" isList="true">
          <value>hn,System.String</value>
          <value>vn,System.String</value>
          <value>clinicmember_id,System.Int32</value>
          <value>screen_date,System.DateTime</value>
          <value>pt_name,System.String</value>
          <value>left_eye,System.String</value>
          <value>right_eye,System.String</value>
          <value>clinic,System.String</value>
          <value>other_chronic_text,System.String</value>
          <value>clinic_member_status_name,System.String</value>
          <value>thai_address,System.String</value>
        </Columns>
        <CommandTimeout>30</CommandTimeout>
        <Dictionary isRef="1"/>
        <Name>DataSource1</Name>
        <NameInSource>Connection1</NameInSource>
        <Parameters count="0" isList="true"/>
        <SqlCommand>SELECT

cc.hn, cc.vn,
cc.clinicmember_id,cc.screen_date,concat(pt.pname,pt.fname,'  ',pt.lname) as pt_name,

ds.dmht_eye_screen_result_name as left_eye ,ds2.dmht_eye_screen_result_name as right_eye , 

cm.clinic,cm.other_chronic_text,ca.clinic_member_status_name,

concat(pt.moopart,' ',th.full_name) as thai_address

FROM clinicmember_cormobidity_screen cc

left outer join clinicmember    cm  on cm.clinicmember_id =  cc.clinicmember_id
left outer join clinicmember_cormobidity_eye_screen   ce on ce.clinicmember_cormobidity_screen_id = cc.clinicmember_cormobidity_screen_id

left outer join dmht_eye_screen_result ds on ds.dmht_eye_screen_result_id = ce.dmht_eye_screen_result_left_id
left outer join dmht_eye_screen_result ds2 on ds2.dmht_eye_screen_result_id = ce.dmht_eye_screen_result_right_id
left outer join patient pt on pt.hn = cc.hn
left outer join clinic_member_status ca on ca.clinic_member_status_id = cm.clinic_member_status_id

left outer join thaiaddress th on th.addressid = concat(pt.chwpart,pt.amppart,pt.tmbpart)

WHERE 

cm.clinic='001'    and (cm.other_chronic_text like '%ความดันโลหิตสูง%')  and 
screen_date between '{datestart}' and '{dateend}'
and (cc.do_eye_screen='Y')      


order by    cc.screen_date</SqlCommand>
      </DataSource1>
    </DataSources>
    <Relations count="0" isList="true"/>
    <Report isRef="0"/>
    <Variables count="2" isList="true">
      <value>,datestart,เลือกวันที่เริ่มต้น,System.String,_x0032_013_x002D_10_x002D_01,False,False</value>
      <value>,dateend,เลือกวันที่สิ้นสุด,System.String,_x0032_013_x002D_10_x002D_01,False,False</value>
    </Variables>
  </Dictionary>
  <EngineVersion>EngineV2</EngineVersion>
  <GlobalizationStrings count="0" isList="true"/>
  <MetaTags count="0" isList="true"/>
  <Pages count="1" isList="true">
    <Page1 isKey="true" type="Page" Ref="4">
      <Border>None;Black;2;Solid;False;4;Black</Border>
      <Brush>Transparent</Brush>
      <Components count="4" isList="true">
        <PageHeaderBand1 isKey="true" type="PageHeaderBand" Ref="5">
          <Brush>Transparent</Brush>
          <ClientRectangle>0,0.4,19,2.8</ClientRectangle>
          <Components count="5" isList="true">
            <Text1 isKey="true" type="Text" Ref="6">
              <Brush>Transparent</Brush>
              <ClientRectangle>0.2,0.6,18.6,1</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,14,Bold</Font>
              <HorAlignment>Center</HorAlignment>
              <Margins>0,0,0,0</Margins>
              <Name>Text1</Name>
              <Page isRef="4"/>
              <Parent isRef="5"/>
              <Text>รายงานจำนวนคนไข้คลินิคเบาหวาน (DM+HT) ได้รับการตรวจตา</Text>
              <TextBrush>Black</TextBrush>
            </Text1>
            <Text14 isKey="true" type="Text" Ref="7">
              <Brush>Transparent</Brush>
              <ClientRectangle>6.6,1.8,2.6,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,14</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text14</Name>
              <Page isRef="4"/>
              <Parent isRef="5"/>
              <Text>{datestart}</Text>
              <TextBrush>Black</TextBrush>
            </Text14>
            <Text15 isKey="true" type="Text" Ref="8">
              <Brush>Transparent</Brush>
              <ClientRectangle>4,1.8,2.8,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,14</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text15</Name>
              <Page isRef="4"/>
              <Parent isRef="5"/>
              <Text>ระหว่างวันที่</Text>
              <TextBrush>Black</TextBrush>
            </Text15>
            <Text16 isKey="true" type="Text" Ref="9">
              <Brush>Transparent</Brush>
              <ClientRectangle>10.8,1.8,2.6,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,14</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text16</Name>
              <Page isRef="4"/>
              <Parent isRef="5"/>
              <Text>{dateend}</Text>
              <TextBrush>Black</TextBrush>
            </Text16>
            <Text17 isKey="true" type="Text" Ref="10">
              <Brush>Transparent</Brush>
              <ClientRectangle>9.2,1.8,1.6,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,14</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text17</Name>
              <Page isRef="4"/>
              <Parent isRef="5"/>
              <Text>ถึงวันที่</Text>
              <TextBrush>Black</TextBrush>
            </Text17>
          </Components>
          <Conditions count="0" isList="true"/>
          <Name>PageHeaderBand1</Name>
          <Page isRef="4"/>
          <Parent isRef="4"/>
        </PageHeaderBand1>
        <HeaderBand1 isKey="true" type="HeaderBand" Ref="11">
          <Brush>Transparent</Brush>
          <ClientRectangle>0,4,19,0.8</ClientRectangle>
          <Components count="5" isList="true">
            <Text3 isKey="true" type="Text" Ref="12">
              <Brush>Transparent</Brush>
              <ClientRectangle>0.4,0,1.6,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10,Bold</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text3</Name>
              <Page isRef="4"/>
              <Parent isRef="11"/>
              <Text>HN</Text>
              <TextBrush>Black</TextBrush>
            </Text3>
            <Text13 isKey="true" type="Text" Ref="13">
              <Brush>Transparent</Brush>
              <ClientRectangle>2.2,0,2.8,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10,Bold</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text13</Name>
              <Page isRef="4"/>
              <Parent isRef="11"/>
              <Text>ชื่อ - สกุล</Text>
              <TextBrush>Black</TextBrush>
            </Text13>
            <Text10 isKey="true" type="Text" Ref="14">
              <Brush>Transparent</Brush>
              <ClientRectangle>6.4,0,3.2,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10,Bold</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text10</Name>
              <Page isRef="4"/>
              <Parent isRef="11"/>
              <Text>ที่อยู่</Text>
              <TextBrush>Black</TextBrush>
            </Text10>
            <Text5 isKey="true" type="Text" Ref="15">
              <Brush>Transparent</Brush>
              <ClientRectangle>12.2,0,2.8,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10,Bold</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text5</Name>
              <Page isRef="4"/>
              <Parent isRef="11"/>
              <Text>ตาซ้าย</Text>
              <TextBrush>Black</TextBrush>
            </Text5>
            <Text6 isKey="true" type="Text" Ref="16">
              <Brush>Transparent</Brush>
              <ClientRectangle>15.8,0,2.8,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10,Bold</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text6</Name>
              <Page isRef="4"/>
              <Parent isRef="11"/>
              <Text>ตาขวา</Text>
              <TextBrush>Black</TextBrush>
            </Text6>
          </Components>
          <Conditions count="0" isList="true"/>
          <Name>HeaderBand1</Name>
          <Page isRef="4"/>
          <Parent isRef="4"/>
        </HeaderBand1>
        <DataBand1 isKey="true" type="DataBand" Ref="17">
          <Brush>Transparent</Brush>
          <CanBreak>True</CanBreak>
          <ClientRectangle>0,5.6,19,0.8</ClientRectangle>
          <Components count="5" isList="true">
            <Text2 isKey="true" type="Text" Ref="18">
              <Brush>Transparent</Brush>
              <ClientRectangle>0.4,0,1.6,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text2</Name>
              <Page isRef="4"/>
              <Parent isRef="17"/>
              <Text>{DataSource1.hn}</Text>
              <TextBrush>Black</TextBrush>
            </Text2>
            <Text4 isKey="true" type="Text" Ref="19">
              <Brush>Transparent</Brush>
              <ClientRectangle>2.4,0,3.8,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text4</Name>
              <Page isRef="4"/>
              <Parent isRef="17"/>
              <Text>{DataSource1.pt_name}</Text>
              <TextBrush>Black</TextBrush>
            </Text4>
            <Text8 isKey="true" type="Text" Ref="20">
              <Brush>Transparent</Brush>
              <ClientRectangle>6.4,0,5.4,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text8</Name>
              <Page isRef="4"/>
              <Parent isRef="17"/>
              <Text>{DataSource1.thai_address}</Text>
              <TextBrush>Black</TextBrush>
            </Text8>
            <Text7 isKey="true" type="Text" Ref="21">
              <Brush>Transparent</Brush>
              <ClientRectangle>12,0,3.2,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text7</Name>
              <Page isRef="4"/>
              <Parent isRef="17"/>
              <Text>{DataSource1.left_eye}</Text>
              <TextBrush>Black</TextBrush>
            </Text7>
            <Text9 isKey="true" type="Text" Ref="22">
              <Brush>Transparent</Brush>
              <ClientRectangle>15.4,0,3.4,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text9</Name>
              <Page isRef="4"/>
              <Parent isRef="17"/>
              <Text>{DataSource1.right_eye}</Text>
              <TextBrush>Black</TextBrush>
            </Text9>
          </Components>
          <Conditions count="0" isList="true"/>
          <DataSourceName>DataSource1</DataSourceName>
          <Filters count="0" isList="true"/>
          <Name>DataBand1</Name>
          <Page isRef="4"/>
          <Parent isRef="4"/>
          <Sort count="0" isList="true"/>
        </DataBand1>
        <FooterBand1 isKey="true" type="FooterBand" Ref="23">
          <Brush>Transparent</Brush>
          <ClientRectangle>0,7.2,19,1.2</ClientRectangle>
          <Components count="2" isList="true">
            <Text18 isKey="true" type="Text" Ref="24">
              <Brush>Transparent</Brush>
              <ClientRectangle>16.8,0,1.6,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10,Bold</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text18</Name>
              <Page isRef="4"/>
              <Parent isRef="23"/>
              <Text>{Count(DataBand1)}</Text>
              <TextBrush>Black</TextBrush>
            </Text18>
            <Text19 isKey="true" type="Text" Ref="25">
              <Brush>Transparent</Brush>
              <ClientRectangle>12.6,0,4.2,0.6</ClientRectangle>
              <Conditions count="0" isList="true"/>
              <Font>Tahoma,10,Bold</Font>
              <Margins>0,0,0,0</Margins>
              <Name>Text19</Name>
              <Page isRef="4"/>
              <Parent isRef="23"/>
              <Text>จำนวนผู้รับบริการรายคน</Text>
              <TextBrush>Black</TextBrush>
            </Text19>
          </Components>
          <Conditions count="0" isList="true"/>
          <Name>FooterBand1</Name>
          <Page isRef="4"/>
          <Parent isRef="4"/>
        </FooterBand1>
      </Components>
      <Conditions count="0" isList="true"/>
      <Guid>5ceacc4ab7204333cb3156569f48aa36</Guid>
      <Margins>1,1,1,1</Margins>
      <Name>Page1</Name>
      <PageHeight>29.7</PageHeight>
      <PageWidth>21</PageWidth>
      <Report isRef="0"/>
      <Watermark isKey="true" type="Stimulsoft.Report.Components.StiWatermark" Ref="26">
        <Font>Arial,100</Font>
        <TextBrush>[50:0:0:0]</TextBrush>
      </Watermark>
    </Page1>
  </Pages>
  <PrinterSettings isKey="true" type="Stimulsoft.Report.Print.StiPrinterSettings" Ref="27"/>
  <ReportAlias>Report</ReportAlias>
  <ReportChanged>02/19/2016 10:16:39 AM</ReportChanged>
  <ReportCreated>11/14/2013 06:19:46 PM</ReportCreated>
  <ReportFile>C:\AppServ\www\iREPORT\themes\jmobile\views\lamaereport\stimulrep\reports\report_dm_with_ht_screen_eye.mrt</ReportFile>
  <ReportGuid>c359e1cea8a7c760ebacf78783b48d3f</ReportGuid>
  <ReportName>Report</ReportName>
  <ReportUnit>Centimeters</ReportUnit>
  <ReportVersion>2012.1.1300</ReportVersion>
  <ScriptLanguage>CSharp</ScriptLanguage>
  <Styles count="0" isList="true"/>
</StiSerializer>